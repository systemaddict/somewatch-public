<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raw File Upload with Uppy</title>
    <!-- Pull Uppy from CDN -->
    <link href="https://releases.transloadit.com/uppy/v4.13.3/uppy.min.css" rel="stylesheet" />
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            color: #2275d7;
        }
        .upload-container {
            margin: 30px 0;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Raw File Upload (No Processing)</h1>
    <p>Files will be uploaded without any additional processing.</p>
    
    <!-- This div is where the inline Dashboard will appear -->
    <div id="uppy-dashboard" class="upload-container"></div>
    
    <!-- Results area for debugging -->
    <div id="results" class="results">Results will appear here after upload...</div>
    
    <script type="module">
        import {
            Uppy,
            Dashboard,
            Transloadit,
        } from 'https://releases.transloadit.com/uppy/v4.13.3/uppy.min.mjs'
        
        const resultsElement = document.getElementById('results');
        
        const uppy = new Uppy()
            .use(Transloadit, {
                waitForEncoding: false, // Don't wait for encoding to finish
                alwaysRunAssembly: true,
                assemblyOptions: {
                    params: {
                        // Simple template that only imports files without any processing
                        steps: {
                            ":original": {
                                "robot": "/upload/handle"
                            }
                        },
                        auth: {
                            key: 'tv2reg', // Your Transloadit key
                        },
                    },
                },
            })
            .use(Dashboard, {
                inline: true,
                target: '#uppy-dashboard',
                height: 450,
                showProgressDetails: true,
                proudlyDisplayPoweredByUppy: true
            })
            .on('upload-success', (file, response) => {
                console.log('Upload success:', file.name);
                resultsElement.textContent = `Upload Complete: ${file.name}\n\nNo processing was performed - raw file uploaded successfully.`;
            })
            .on('complete', ({ successful }) => {
                console.log('All uploads completed:', successful.length, 'successful files');
            })
            .on('error', (error) => {
                console.error(error);
                resultsElement.textContent = `Error: ${error.message || 'Unknown error'}`;
            });
    </script>
</body>
</html>
